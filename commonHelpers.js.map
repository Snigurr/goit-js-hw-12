{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["\nimport axios from \"axios\";\n\nexport async function fetchImages(query) {\n    try {\n        const response = await axios.get(`https://pixabay.com/api/?${query}`);\n        return response.data;\n    } catch (error) {\n        console.error(\"Error while fetching images:\", error);\n        throw error;\n    }\n}","import SimpleLightbox from \"simplelightbox\";\nimport iziToast from \"izitoast\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst addImageButton = document.querySelector(\".add_img_btn\");\nconst list = document.querySelector(\"ul\");\nconst loader = document.querySelector(\".loader\");\n\nlet lightbox;\n\nfunction preloadImages(images) {\n    return Promise.all(images.map(image => {\n        return new Promise((resolve, reject) => {\n            const img = new Image();\n            img.onload = resolve;\n            img.onerror = reject;\n            img.src = image.largeImageURL;\n        });\n    }));\n}\n\nexport async function renderImages(images, page) {\n    showLoader();\n    try {\n        await preloadImages(images);\n        if (!list) {\n            throw new Error(\"List element not found\");\n        }\n        list.insertAdjacentHTML(\"beforeend\", createMarkup(images));\n\n        if (!lightbox) {\n            lightbox = new SimpleLightbox(\"ul a\", {\n                captionsData: \"alt\",\n                captionDelay: 250,\n            });\n        } else {\n            lightbox.refresh();\n        }\n\n        hideLoader();\n        if (page !== 1) {\n            const height = (list.firstElementChild.getBoundingClientRect().height * 2) + 48;\n            setTimeout(() => {\n                window.scrollBy({\n                    top: height,\n                    behavior: 'smooth',\n                });\n            }, 300);\n        }\n\n        if (images.length < 15) {\n            hideLoaderButton();\n            iziToast.warning({\n                title: \"Warning\",\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: \"topRight\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error while preloading images:\", error);\n    }\n}\n\nexport async function clearImages() {\n    hideLoader();\n    hideLoaderButton();\n    return new Promise(resolve => {\n        if (list) {\n            list.innerHTML = \"\";\n        }\n        resolve();\n    });\n}\n\nfunction createMarkup(arr) {\n    return arr\n        .map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n            <li>\n                <a href=\"${largeImageURL}\" alt=\"${tags}\">\n                    <img src=\"${webformatURL}\" alt=\"${tags}\" width=\"360\" />\n                    <div class=\"image-info\">\n                        <p><span class=\"info-label\">Likes</span><br>${likes}</p>\n                        <p><span class=\"info-label\">Views</span><br>${views}</p>\n                        <p><span class=\"info-label\">Comments</span><br>${comments}</p>\n                        <p><span class=\"info-label\">Downloads</span><br>${downloads}</p>\n                    </div>\n                </a>\n            </li>\n        `)\n        .join(\"\");\n}\n\nfunction showLoader() {\n    if (loader) {\n        loader.style.display = \"block\";\n        hideLoaderButton();\n    }\n}\n\nfunction hideLoader() {\n    if (loader) {\n        loader.style.display = \"none\";\n        addImageButton.style.display = \"block\";\n    }\n}\n\nfunction hideLoaderButton() {\n    addImageButton.style.display = \"none\";\n}\n\nexport function moveLoaderBelowList() {\n    loader.style.position = \"absolute\";\n    loader.style.top = list.offsetTop + list.offsetHeight + \"px\";\n}\n\nexport function moveLoaderBelowInput(input) {\n    loader.style.position = \"absolute\";\n    loader.style.top = input.offsetTop + input.offsetHeight + \"px\";\n}\n","import { fetchImages } from \"./js/pixabay-api.js\";\nimport { renderImages, clearImages, moveLoaderBelowList, moveLoaderBelowInput } from \"./js/render-functions.js\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\ndocument.addEventListener(\"DOMContentLoaded\", function () {\n    const form = document.getElementById(\"search-form\");\n    const searchInput = document.getElementById(\"search-img\");\n    const addImageButton = document.querySelector(\".add_img_btn\");\n    const API_KEY = \"43273771-9fb27172998fac0872066584a\";\n\n    let currentPage = 1;\n    let query;\n\n    form.addEventListener(\"submit\", async event => {\n        event.preventDefault();\n        query = searchInput.value.trim();\n        if (query) {\n            currentPage = 1;\n            try {\n                await clearImages();\n                moveLoaderBelowInput(searchInput);\n                await fetchAllImages(query);\n            } catch (error) {\n                handleFetchError(error);\n            }\n        } else {\n            iziToast.warning({\n                title: \"Warning\",\n                message: \"Please enter a search query.\",\n                position: \"topRight\"\n            });\n        }\n    });\n\n    async function fetchAllImages(query) {\n        searchInput.value = \"\";\n        const params = new URLSearchParams({\n            key: API_KEY,\n            q: query,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: \"true\",\n            page: currentPage,\n            per_page: 15\n        });\n        try {\n            const data = await fetchImages(params);\n            if (data.hits.length === 0) {\n                clearImages();\n                throw new Error(\"Sorry, there are no images matching your search query. Please try again!\");\n            }\n            renderImages(data.hits, currentPage);\n        } catch (error) {\n            throw error;\n        }\n    }\n\n    addImageButton.addEventListener(\"click\", async () => {\n        moveLoaderBelowList();\n        try {\n            await onLoadMoreImages();\n        } catch (error) {\n            handleFetchError(error);\n        }\n    });\n\n    async function onLoadMoreImages() {\n        currentPage++;\n        try {\n            await fetchAllImages(query);\n        } catch (error) {\n            throw error;\n        }\n    }\n\n    function handleFetchError(error) {\n        console.error(error);\n        iziToast.error({\n            message: 'An error occurred while fetching images. Please try again later.',\n            position: 'topRight',\n        });\n    }\n});\n"],"names":["fetchImages","query","axios","error","addImageButton","list","loader","lightbox","preloadImages","images","image","resolve","reject","img","renderImages","page","showLoader","createMarkup","SimpleLightbox","hideLoader","height","hideLoaderButton","iziToast","clearImages","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","moveLoaderBelowList","moveLoaderBelowInput","input","form","searchInput","API_KEY","currentPage","event","fetchAllImages","handleFetchError","params","data","onLoadMoreImages"],"mappings":"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"}