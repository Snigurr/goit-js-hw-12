{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nexport async function fetchImages(query) {\n    return axios.get(`https://pixabay.com/api/?${query}`)\n        .then(response => {\n            return response.data;\n        })\n        .catch(error => {\n            console.error(\"Error while fetching images:\", error);\n            throw error;\n        });\n}\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\n\nlet lightbox; \n\nfunction preloadImages(images) {\n    return new Promise((resolve, reject) => {\n    const imagePromises = images.map(image => {\n        return new Promise((resolve, reject) => {\n            const img = new Image();\n            img.onload = () => resolve();\n            img.onerror = error => reject(error);\n            img.src = image.largeImageURL;\n        });\n    });\n\n    Promise.all(imagePromises)\n        .then(() => resolve())\n        .catch(error => reject(error));\n});\n\n}\n\nexport function renderImages(images) {\n    showLoader();\n    preloadImages(images)\n        .then(() => {\n            const list = document.querySelector(\"ul\");\n            \n            if (!list) {\n                throw new Error(\"List element not found\");\n            }\n            list.insertAdjacentHTML(\"beforeend\", createMarkup(images));\n            \n            if (!lightbox) {\n                lightbox = new SimpleLightbox(\"ul a\", {\n                    captionsData: \"alt\",\n                    captionDelay: 250,\n                });\n            } else {\n                lightbox.refresh();\n            }\n\n            hideLoader();\n            \n        })\n        .catch(error => {\n            console.error(\"Error while preloading images:\", error);\n        });\n}\n\n\n\nexport function clearImages() {\n    return new Promise(resolve => {\n        const list = document.querySelector(\"ul\");\n        if (list) {\n            list.innerHTML = \"\";\n        }\n        resolve();\n    });\n}\n\nfunction createMarkup(arr) {\n    return arr\n        .map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n            <li>\n                <a href=\"${largeImageURL}\" alt=\"${tags}\">\n                    <img src=\"${webformatURL}\" alt=\"${tags}\" width=\"360\" />\n                    <p class=\"image-info\">\n                        <span>Likes<br> ${likes}</span>\n                        <span>Views<br> ${views}</span>\n                        <span>Comments<br> ${comments}</span>\n                        <span>Downloads<br> ${downloads}</span>\n                    </p>\n                </a>\n            </li>\n        `)\n        .join(\"\");\n    \n}\n\nexport function showLoader() {\n    const loader = document.querySelector(\".loader\");\n    if (loader) {\n        loader.style.display = \"block\";\n    }\n}\n\nexport function hideLoader() {\n    const loader = document.querySelector(\".loader\");\n    if (loader) {\n        loader.style.display = \"none\";\n    }\n}\n\nexport function moveLoaderBelowButton(button) {\n    const loader = document.querySelector(\".loader\");\n    loader.style.position = \"absolute\";\n    loader.style.top = button.offsetTop + button.offsetHeight + \"px\";\n    loader.style.left = button.offsetLeft + \"px\";\n}\n\nexport function moveLoaderBelowInput(input) {\n    const loader = document.querySelector(\".loader\");\n    loader.style.position = \"absolute\";\n    loader.style.top = input.offsetTop + input.offsetHeight + \"px\";\n    loader.style.left = input.offsetLeft + \"px\";\n}\n\n","import { fetchImages } from \"./js/pixabay-api.js\";\nimport { renderImages, showLoader, clearImages, hideLoader, moveLoaderBelowButton, moveLoaderBelowInput } from \"./js/render-functions.js\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n\n\ndocument.addEventListener(\"DOMContentLoaded\", function() {\n    const form = document.getElementById(\"search-form\");\n    const searchInput = document.getElementById(\"search-img\");\n    const addImageButton = document.querySelector(\".add_img_btn\");\n    const API_KEY = \"43273771-9fb27172998fac0872066584a\";\n    \n\n    let currentPage = 1;\n    let query = '';\n\n\n\n    form.addEventListener(\"submit\", async event => {\n        event.preventDefault();\n        query = searchInput.value.trim();\n        \n        if (query) {\n            \n            currentPage = 1; \n            clearImages().then(() => {\n                moveLoaderBelowInput(searchInput);\n                showLoader();\n                fetchAllImages(query);  \n            });\n        } else {\n            iziToast.warning({\n                title: \"Warning\",\n                message: \"Please enter a search query.\",\n                position: \"topRight\"\n            });\n        }\n    });\n\n    async function fetchAllImages() {\n        const query = searchInput.value.trim();\n        const params = new URLSearchParams({\n            key: API_KEY,\n            q: query,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: \"true\",\n            page: currentPage, \n            per_page: 15\n        });\n        fetchImages(params)\n            .then(data => {\n                if (data.hits.length === 0) {\n                    clearImages();\n                    showLoader();\n                    throw new Error(\"Sorry, there are no images matching your search query. Please try again!\");\n                }\n                renderImages(data.hits, \"ul.gallery\");\n                \n                if (data.hits.length < 15) {\n                    hideLoadMoreButton();\n                    iziToast.warning({\n                        title: \"Warning\",\n                        message: \"There are fewer than 15 images available.\",\n                        position: \"topRight\"\n                    });\n            }\n            })\n            .catch(error => {\n                searchInput.value = \"\";\n                iziToast.error({\n                    title: \"Error\",\n                    message: error.message,\n                    position: \"topRight\"\n                });\n            });\n    }\n\n    addImageButton.addEventListener(\"click\", () => {\n        showLoader();\n        moveLoaderBelowButton(addImageButton);\n        onLoadMoreImages();\n    });\n\n    async function onLoadMoreImages() {\n        showLoader(); \n        currentPage++; \n        try {\n            await fetchAllImages();\n        } catch (error) {\n            console.error(error);\n            iziToast.error({\n                message: 'An error occurred while fetching images. Please try again later.',\n                position: 'topRight',\n            });\n        } finally {\n            hideLoader();\n        }\n    }\n\n    function hideLoadMoreButton() {\n        addImageButton.style.display = \"none\";\n    }\n});\n"],"names":["fetchImages","query","axios","response","error","lightbox","preloadImages","images","resolve","reject","imagePromises","image","img","renderImages","showLoader","list","createMarkup","SimpleLightbox","hideLoader","clearImages","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","loader","moveLoaderBelowButton","button","moveLoaderBelowInput","input","form","searchInput","addImageButton","API_KEY","currentPage","event","fetchAllImages","iziToast","params","data","hideLoadMoreButton","onLoadMoreImages"],"mappings":"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"}