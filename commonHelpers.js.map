{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nexport async function fetchImages(query) {\n    return axios.get(`https://pixabay.com/api/?${query}`)\n        .then(response => {\n            return response.data;\n        })\n        .catch(error => {\n            console.error(\"Error while fetching images:\", error);\n            throw error;\n        });\n}\n","import SimpleLightbox from \"simplelightbox\";\n    import iziToast from \"izitoast\";\n    import \"simplelightbox/dist/simple-lightbox.min.css\";\n    const addImageButton = document.querySelector(\".add_img_btn\");\n    const list = document.querySelector(\"ul\");\n    const loader = document.querySelector(\".loader\");\n\n    let lightbox; \n\n    function preloadImages(images) {\n        return new Promise((resolve, reject) => {\n        const imagePromises = images.map(image => {\n            return new Promise((resolve, reject) => {\n                const img = new Image();\n                img.onload = () => resolve();\n                img.onerror = error => reject(error);\n                img.src = image.largeImageURL;\n            });\n        });\n\n        Promise.all(imagePromises)\n            .then(() => resolve())\n            .catch(error => reject(error));\n    });\n\n    }\n\n    export function renderImages(images, page) {\n        showLoader();\n        preloadImages(images)\n            .then(() => {\n                if (!list) {\n                    throw new Error(\"List element not found\");\n                }\n                list.insertAdjacentHTML(\"beforeend\", createMarkup(images));\n                \n                if (!lightbox) {\n                    lightbox = new SimpleLightbox(\"ul a\", {\n                        captionsData: \"alt\",\n                        captionDelay: 250,\n                    });\n                } else {\n                    lightbox.refresh();\n                }\n\n                hideLoader();\n                if(page !== 1){\n                    const height = (list.firstElementChild.getBoundingClientRect().height * 2) + 48;\n                    setTimeout(() => {\n                        window.scrollBy({\n                            top: height,\n                            behavior: 'smooth',\n                        });\n                    }, 300);\n                }\n\n                if(images.length < 15){\n                    hideLoaderButton();\n                    iziToast.warning({\n                        title: \"Warning\",\n                        message: \"There are fewer than 15 images available.\",\n                        position: \"topRight\"\n                    });\n                }\n                \n            })\n            .catch(error => {\n                console.error(\"Error while preloading images:\", error);\n            });\n    }\n\n\n\n    export function clearImages() {\n        hideLoader();\n        hideLoaderButton();\n        return new Promise(resolve => {\n            if (list) {\n                list.innerHTML = \"\";\n            }\n            resolve();\n        });\n    }\n\n    function createMarkup(arr) {\n        return arr\n            .map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n                <li>\n                    <a href=\"${largeImageURL}\" alt=\"${tags}\">\n                        <img src=\"${webformatURL}\" alt=\"${tags}\" width=\"360\" />\n                        <div class=\"image-info\">\n    <p><span class=\"info-label\">Likes</span><br>${likes}</p>\n    <p><span class=\"info-label\">Views</span><br>${views}</p>\n    <p><span class=\"info-label\">Comments</span><br>${comments}</p>\n    <p><span class=\"info-label\">Downloads</span><br>${downloads}</p>\n</div>\n\n                    </a>\n                </li>\n            `)\n            .join(\"\");\n        \n    }\n\n    function showLoader() {\n        if (loader) {\n            loader.style.display = \"block\";\n            hideLoaderButton();\n        }\n    }\n\n    function hideLoader() {\n        if (loader) {\n            loader.style.display = \"none\";\n            addImageButton.style.display = \"block\";\n        }\n    }\n\n    function hideLoaderButton(){\n        addImageButton.style.display = \"none\";\n    }\n\n    export function moveLoaderBelowList() {\n        loader.style.position = \"absolute\";\n        loader.style.top = list.offsetTop + list.offsetHeight + \"px\";\n}\n\nexport function moveLoaderBelowInput(input) {\n        loader.style.position = \"absolute\";\n        loader.style.top = input.offsetTop + input.offsetHeight + \"px\";\n    }","import { fetchImages } from \"./js/pixabay-api.js\";\nimport { renderImages, clearImages, moveLoaderBelowList, moveLoaderBelowInput} from \"./js/render-functions.js\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n\n\ndocument.addEventListener(\"DOMContentLoaded\", function() {\n    const form = document.getElementById(\"search-form\");\n    const searchInput = document.getElementById(\"search-img\");\n    const addImageButton = document.querySelector(\".add_img_btn\");\n    const API_KEY = \"43273771-9fb27172998fac0872066584a\";\n    \n    let currentPage = 1;\n    let query;\n\n    form.addEventListener(\"submit\", async event => {\n        event.preventDefault();\n        query = searchInput.value.trim();\n        if (query) {\n            currentPage = 1; \n            clearImages().then(() => {\n                moveLoaderBelowInput(searchInput);\n                fetchAllImages(query); \n            });\n        } else {\n            iziToast.warning({\n                title: \"Warning\",\n                message: \"Please enter a search query.\",\n                position: \"topRight\"\n            });\n        }\n    });\n\n    async function fetchAllImages() {\n        searchInput.value = \"\";\n        const params = new URLSearchParams({\n            key: API_KEY,\n            q: query,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: \"true\",\n            page: currentPage, \n            per_page: 15\n        });\n        fetchImages(params)\n            .then(data => {\n                if (data.hits.length === 0) {\n                    clearImages();\n                    throw new Error(\"Sorry, there are no images matching your search query. Please try again!\");\n                }\n                renderImages(data.hits, currentPage);\n            })\n            .catch(error => {\n                iziToast.error({\n                    title: \"Error\",\n                    message: error.message,\n                    position: \"topRight\"\n                });\n            })\n    }\n\n    addImageButton.addEventListener(\"click\", () => {\n        moveLoaderBelowList();\n        onLoadMoreImages();\n    });\n\n    async function onLoadMoreImages() {\n        currentPage++; \n        try {\n            await fetchAllImages();\n        } catch (error) {\n            console.error(error);\n            iziToast.error({\n                message: 'An error occurred while fetching images. Please try again later.',\n                position: 'topRight',\n            });\n        }\n    }\n});"],"names":["fetchImages","query","axios","response","error","addImageButton","list","loader","lightbox","preloadImages","images","resolve","reject","imagePromises","image","img","renderImages","page","showLoader","createMarkup","SimpleLightbox","hideLoader","height","hideLoaderButton","iziToast","clearImages","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","moveLoaderBelowList","moveLoaderBelowInput","input","form","searchInput","API_KEY","currentPage","event","fetchAllImages","params","data","onLoadMoreImages"],"mappings":"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"}